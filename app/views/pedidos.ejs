<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedidos</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div id="root">
        <div class="App">
            <div class="dashboard-container">
                <header class="dashboard-header">
                    <div style="width: 83px;"></div>
                    <button class="return-button" onclick="window.location.href='/'"><</button>
                    <img alt="Raphietro Atelier Logo" class="dashboard-logo" src="/image/logo-raphietro-DpL_DJD5.png">
                    <button class="logout-button" onclick="window.location.href='/logout'">Sair</button>
                </header>
                <div class="dashboard-content">
                    <h2>Pedidos</h2>
                    <% function formatDate(dt) {
                        if (!dt) return '';
                        const d = new Date(dt);
                        if (isNaN(d.getTime())) return String(dt);
                        const dd = String(d.getDate()).padStart(2, '0');
                        const mm = String(d.getMonth() + 1).padStart(2, '0');
                        const yy = String(d.getFullYear()).slice(-2);
                        const hh = String(d.getHours()).padStart(2, '0');
                        const min = String(d.getMinutes()).padStart(2, '0');
                        return dd + '/' + mm + '/' + yy + ' ' + hh + ':' + min;
                    } %>
                    <a href="/pedidos/novo" class="dashboard-button">Novo Pedido</a>
                    <% if (typeof pedidos !== 'undefined' && pedidos.length > 0) { %>
                        <div class="pedidos-list">
                            <% pedidos.forEach(function(pedido) { %>
                                <div class="cards-pedidos">
                                    <strong>Descrição:</strong> <%= pedido.Descricao %> <br>
                                    <strong>Costureiro:</strong> <%= pedido.Nome_Costureiro %> <br>
                                    <strong>Estado:</strong> <%= pedido.Estado %> <br>
                                    <strong>Valor:</strong> <%= pedido.Valor_Total %> <br>
                                    <strong>Data:</strong> <%= formatDate(pedido.Data_Pedido) %> <br>
                                    <div class="card-actions">
                                        <a class="dashboard-button" href="/pedidos/<%= pedido.Pedido_ID %>/editar">Editar</a>
                                        <form action="/pedidos/<%= pedido.Pedido_ID %>/delete" method="POST" style="display:inline">
                                            <button type="submit" class="return-button" onclick="return confirm('Confirma exclusão deste pedido?');">Excluir</button>
                                        </form>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                    <% } else { %>
                        <p>Nenhum pedido cadastrado no momento.</p>
                    <% } %>
                </div>
            </div>
        </div>
    </div>
</body>
</html>